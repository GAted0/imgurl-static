<!DOCTYPE html>
<html lang="zh-cmn-Hans" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<title>ImgURL图床单页版</title>
	<meta name="generator" content="EverEdit" />
	<meta name="author" content="" />
	<meta name="keywords" content="ImgURL,SM.MS,Chevereto,Lsky Pro,兰空图床" />
	<meta name="description" content="ImgURL诞生于2017年12月，是一款开源的图片管理系统（简称图床），使用PHP + SQLite3开发。" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./favicon.ico"  type="image/x-icon" />
	<link rel="Bookmark" href="./favicon.ico" />
    <link rel="stylesheet" href="./static/layui/css/layui.css">
    <link rel="stylesheet" href="./static/style.css?v=v2.1.3-20190407">
    <script src="./static/jquery.min.js"></script>
    <script src="./static/layui/layui.js"></script>
    <script src="./static/embed.js?v=v2.1.3-20190407"></script>
</head>
<body>
	<!-- 顶部导航栏 -->
    <div class = "header">
        <div class = "layui-container">
            <div class = "layui-row">
                <div class = "layui-col-lg12">
                    <div class="left-menu">
                        <a href="/">
                            <div id="logo">
                                <img src="./static/images/logo.png">
                            </div>
                        </a>
                    </div>
                    <div class = "layui-hide-xs menu">
                        <ul class="layui-nav" lay-filter="">
                            <li class="layui-nav-item"><a href="https://imgurl.org/found"><i class="layui-icon layui-icon-search"></i> 探索发现</a></li>
                            <li class="layui-nav-item"><a href="https://imgurl.org/home/log"><i class="layui-icon layui-icon-notice"></i> 更新日志</a></li>
                            <li class="layui-nav-item"><a href="https://doc.xiaoz.me/#/imgurl2/api" target = "_blank"><i class="layui-icon layui-icon-template-1"></i> API</a></li>
                            <li class="layui-nav-item"><a href="https://doc.xiaoz.me/#/imgurl2/" target = "_blank" rel = "nofollow"><i class="layui-icon">&#xe705;</i> 帮助文档</a></li>
                            <li class="layui-nav-item"><a href="https://github.com/helloxz/imgurl" target = "_blank" rel = "nofollow"><i class="layui-icon">&#xe635;</i> 源码</a></li>
                            <li class="layui-nav-item"><a href="https://imgurl.org/page/use"><i class="layui-icon">&#xe60b;</i> 关于</a></li>
                            <!-- 简单判断用户是否登录 -->
                                                        <!-- 简单判断用户是否登录END -->
                        </ul>
                    </div>
                    <div class = "layui-hide-lg layui-hide-xs">
                        <ul class="layui-nav menu" lay-filter="">
                            <li class="layui-nav-item"><a href="found.php">探索发现</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 顶部导航栏END --><div class="layui-container">
    <div class="layui-row">
        <!-- 首页主要区域 -->
        <div class="layui-col-lg12">
            <div id="main">
                <div class="alert alert-warning" role="alert">
                    <span class="alert-inner--icon"><i class="layui-icon"></i></span>
                    <span class="alert-inner--text"><strong>注意：</strong>游客限制每日上传10张，单张图片不能超过5M，上传的图片将公开显示，使用之前请先阅读《<a href = "https://imgurl.org/page/use">使用协议</a>》</span>
                </div>
                <!-- 选择按钮 -->
                <!-- 选择按钮END -->
                <!-- 上传区域 -->
                <div class="layui-form-item">
                <div class="layui-upload-drag" id="upimg">
                    <i class="layui-icon"></i>
                    <p>将图片拖拽到此处，支持Ctrl + V粘贴上传</p>
                </div>
                </div>
                <!-- 上传区域END -->
            </div>
        </div>
        <!-- 首页主要区域END -->
    </div>
    <div class="layui-row">
        <div class="layui-col-lg12" id = "imgshow">
            <!-- 图片显示区域 -->
            <!-- 显示缩略图 -->
            <div class="layui-col-lg4">
                <div id = "img-thumb"><a href="" target = "_blank"><img src="" alt=""></a></div>
            </div>
            <!-- 显示地址 -->
            <div class="layui-col-lg7 layui-col-md-offset1">
                <div id="links">
                    <table class="layui-table" lay-skin="nob">
                        <colgroup>
                            <col width="80">
                            <col width="450">
                            <col>
                        </colgroup>
                        <tbody>
                            <tr>
                                <td>URL</td>
                                <td><input type="text" class="layui-input" id="url" data-cip-id="url"></td>
                                <td><a href="javascript:;" class="layui-btn layui-btn-sm" onclick="copyurl('url')">复制</a></td>
                            </tr>
                            <tr>
                                <td>HTML</td>
                                <td><input type="text" class="layui-input" id="html" data-cip-id="html"></td>
                                <td><a href="javascript:;" class="layui-btn layui-btn-sm" onclick="copyurl('html')">复制</a></td>
                            </tr>
                            <tr>
                                <td>Markdown</td>
                                <td><input type="text" class="layui-input" id="markdown" data-cip-id="markdown"></td>
                                <td><a href="javascript:;" class="layui-btn layui-btn-sm" onclick="copyurl('markdown')">复制</a></td>
                            </tr>
                            <tr>
                                <td>BBCode</td>
                                <td><input type="text" class="layui-input" id="bbcode" data-cip-id="bbcode"></td>
                                <td><a href="javascript:;" class="layui-btn layui-btn-sm" onclick="copyurl('bbcode')">复制</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- 图片显示区域END -->
        </div>
    </div>
</div>
<!--Ctrl + V粘贴上传-->
<script src = "./static/js/PasteUpload.js"></script>
<script>
	var load1 = document.querySelector("#upimg");

	// 实例化即可
	new ctrlVUtil({
	    uploadUrl: domain + "/api/upload/parse",
	    targetElement: load1,
		isCompleteImg:false,
	    data:{
	        name:"alanzhang",
	    },
	    success:function(data){
	        //转为对象
	        var res = data;
	        //上传成功
	        if(res.code == 200){
		        layer.closeAll('loading'); 
                //layer.closeAll('loading'); 
                $("#img-thumb a").attr('href',domain + '/img/' + res.imgid);
                $("#img-thumb img").attr('src',res.thumbnail_url);
                $("#url").val(res.url);
                $("#html").val("<img src = '" + res.url + "' />");
                $("#markdown").val("![](" + res.url + ")");
                $("#bbcode").val("[img]" + res.url + "[/img]");
                $("#imgshow").show();

                //对图片进行鉴黄识别
                $.get(domain + "/deal/identify/" + res.id,function(data,status){
                    var re = JSON.parse(data);
                    //状态码为400，说明该图片存在异常
                    if(re.code == 400){
                        layer.open({
                            title: '警告！'
                            ,content: '您的IP已被记录，请不要上传违规图片！'
                        }); 
                    }
                    else{
                        console.log(re.code);
                    }
                });
	        }
	        else{
		        layer.msg(res.msg);
	        }
	    },
		error: function(error){
			layer.closeAll('loading'); 
			layer.msg('上传失败！');
		}
	});
</script>
<!--粘贴上传END-->
	<!-- 底部 -->
	<div class = "footer">
		<div class = "layui-container">
			<div class = "layui-row">
				<div class = "layui-col-lg12">
					Copyright © 2017-2019 Powered by <a href="https://imgurl.org/" target = "_blank">ImgURL</a> | Author <a href="https://www.xiaoz.me/" target = "_blank">xiaoz.me</a>
				</div>
			</div>
		</div>
	</div>
	<!-- 底部END -->
	<script src="./static/clipBoard.min.js?v=1.40"></script>
</body>
</html>